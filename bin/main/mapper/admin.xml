<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.silver.hallofart.repository.interfaces.AdminRepository"> 

	<select id="findAll" resultType="com.silver.hallofart.repository.model.Show">
		select id
				 ,title
				 ,content
				 ,start_date
				 ,end_date
				 ,FORMAT(price,0) price
				 ,show_status
				 ,show_img
				 ,show_type_id1
				 ,hall_tb_id
		from show_tb
		order by id desc
	</select>
		
	<update id="updateStatus">
		update show_tb set show_status = #{showStatus} where id = #{id}
	</update>
	
	<select id="findCountAll" resultType="com.silver.hallofart.dto.AdminDto">
		select (select count(*) from user_tb) total_user
				, (select count(*) from show_tb where show_type_id1 = 1) total_show1
		    	, (select count(*) from show_tb where show_type_id1 = 2) total_show2
		from dual
	</select>
	
	<select id="findBookingAll" resultType="com.silver.hallofart.dto.AdminDto">
		select s.title, b.seat_tb_id, p.reg_date, FORMAT(p.amount,0) amount
		from booking_tb b
		join show_tb s on s.id = b.show_tb_id
		join payment_tb p on b.merchant_id = p.merchant_id
	</select>

	<select id="findMerchantAll" resultType="com.silver.hallofart.dto.PaymentDto">
		select merchant_id, imp_id, reg_date, FORMAT(amount,0) amount
		from payment_tb
	</select>
	
</mapper>